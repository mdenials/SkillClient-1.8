package com.skillclient.modules.exploit;

import com.skillclient.events.api.EventTarget;
import net.minecraft.item.EnumAction;
import net.minecraft.network.Packet;
import com.skillclient.wrapper.SkillWrapper;
import net.minecraft.network.play.client.C09PacketHeldItemChange;
import net.minecraft.network.play.client.C08PacketPlayerBlockPlacement;
import net.minecraft.network.play.client.C07PacketPlayerDigging;
import com.skillclient.events.EventPacketSend;
import com.skillclient.main.Register;
import com.skillclient.misc.ValueNumber;
import com.skillclient.misc.ValueBoolean;
import com.skillclient.misc.Module;

public class ItemSpoof extends Module
{
    ValueBoolean pre;
    ValueNumber slot;
    
    public ItemSpoof() {
        super("ItemSpoof", Register.Category.EXPLOIT, "Spoof your Slot.");
        this.pre = new ValueBoolean("Pre", (Module)this, false);
        this.slot = new ValueNumber("Slot", (Module)this, 9.0, 1.0, 1.0, 0);
    }
    
    @EventTarget(2)
    public void onUpdate(final EventPacketSend event) {
        final Packet p = event.getPacket();
        if (p instanceof C07PacketPlayerDigging || p instanceof C08PacketPlayerBlockPlacement) {
            if (this.pre.getValue()) {
                SkillWrapper.sendPacket((Packet)new C09PacketHeldItemChange(0));
                SkillWrapper.sendPacketSoon((Packet)new C09PacketHeldItemChange(1));
            }
            else {
                SkillWrapper.sendPacket((Packet)new C09PacketHeldItemChange(ItemSpoof.mc.thePlayer.inventory.currentItem));
                if (ItemSpoof.mc.thePlayer.getHeldItem().getItem().getItemUseAction(ItemSpoof.mc.thePlayer.getHeldItem()).equals((Object)EnumAction.NONE) || ItemSpoof.mc.thePlayer.isUsingItem()) {
                    SkillWrapper.sendPacketSoon((Packet)new C09PacketHeldItemChange(this.slot.getInt() - 1));
                }
            }
        }
    }
    
    public static int getSlot(final int old) {
        if (!((ItemSpoof)Register.getModule((Class)ItemSpoof.class)).isActive()) {
            return old;
        }
        if (((ItemSpoof)Register.getModule((Class)ItemSpoof.class)).pre.getValue()) {
            return 1;
        }
        return ((ItemSpoof)Register.getModule((Class)ItemSpoof.class)).slot.getInt() - 1;
    }
}
